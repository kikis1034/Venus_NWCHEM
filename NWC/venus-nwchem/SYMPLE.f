      SUBROUTINE SYMPLE(NORDER)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INCLUDE 'SIZES'
      LOGICAL FIRST
C
C         4, 6 or 8-ORDER SYMPLECTIC INTEGRATION OF THE EQUATIONS OF MOTION.
C         PARAMETERS PROVIDED KINDLY BY Christoph Schlier, Sept. 1999.
C
      COMMON/QPDOT/Q(NDA3),PDOT(NDA3)
      COMMON/PQDOT/P(NDA3),QDOT(NDA3),W(NDA)
      COMMON/INTEGR/ATIME,NI,NID
      DIMENSION A(0:34)
      DATA FIRST/.TRUE./
      SAVE FIRST,A,N
C
      IF(FIRST) THEN
       IF (NORDER.EQ.4) THEN
         N=5
         A(0) =  0.5D0
         A(1) = -1.0D0/48.D0
         A(2) =  1.0D0/3.D0
         A(3) =  3.0D0/8.D0
         A(4) = -A(2)
         A(5) =  7.0D0/24.D0
         A(6) = -A(2)
         A(7) =  A(3)
         A(8) =  A(2)
         A(9) =  A(1)
         A(10)=  A(0)
       ELSEIF (NORDER.EQ.6) THEN
         N=8
         A(0) =  0.06942 94434 62529 87735 84886 58247 03402
         A(1) =  0.28487 83771 72800 84052 74534 64566 5783
         A(2) = -0.13315 51983 15982 09409 96130 99513 7351
         A(3) =  0.32783 97575 96129 45412 05467 83673 2554
         A(4) =  0.00129 03891 79810 78974 23048 17464 4328
         A(5) = -0.38122 10427 19326 29475 62278 43742 1127
         A(6) =  0.42243 53656 73641 42699 88196 23802 2683
         A(7) =  0.26850 29079 50396 00010 82275 95502 279
         A(8) =  0.28000 00000 00000 00000 00000 00000 00000
         A(9 )=A(7)
         A(10)=A(6)
         A(11)=A(5)
         A(12)=A(4)
         A(13)=A(3)
         A(14)=A(2)
         A(15)=A(1)
         A(16)=A(0)
       ELSEIF (NORDER.EQ.8) THEN
         N=17
         A(0)  =  0.04463 79505 23590 22755 91399 96257 33590
         A(1)  =  0.13593 25807 16909 59145 54326 42134 95574
         A(2)  =  0.21988 44042 71470 72254 44553 50696 06167
         A(3)  =  0.13024 94678 05238 28601 62119 37781 96846
         A(4)  =  0.10250 36569 39750 69608 26124 10077 79814
         A(5)  =  0.43234 52186 93585 47487 98325 78848 77035
         A(6)  = -0.00477 48291 69168 81658 02248 90639 62934
         A(7)  = -0.58253 47690 40408 45493 11283 79308 61213
         A(8)  = -0.03886 26428 21118 17697 73742 08751 89743
         A(9)  =  0.31548 72853 79404 79698 27360 37972 74199
         A(10) =  0.18681 58374 32971 55471 52615 35039 72746
         A(11) =  0.26500 27549 90620 83398 34600 29630 79872
         A(12) = -0.02405 08473 57473 61993 57358 79824 07554
         A(13) = -0.45040 49249 97722 51180 92289 67121 51891
         A(14) = -0.05897 43301 55923 86914 57532 39267 66330
         A(15) = -0.02168 47617 18613 35324 93438 86847 07580
         A(16) =  0.07282 08003 35901 28173 76189 26412 34244
         A(17) =  0.55121 42963 41970 67334 40560 13815 94315
         A(18) = A(16)
         A(19) = A(15)
         A(20) = A(14)
         A(21) = A(13)
         A(22) = A(12)
         A(23) = A(11)
         A(24) = A(10)
         A(25) = A(9)
         A(26) = A(8)
         A(27) = A(7)
         A(28) = A(6)
         A(29) = A(5)
         A(30) = A(4)
         A(31) = A(3)
         A(32) = A(2)
         A(33) = A(1)
         A(34) = A(0)
       ENDIF
       FIRST=.FALSE.
      ENDIF
C
      DO I=0,N-1
         DO K=1,NI
            KK=(K+2)/3
            P(K)=P(K)+ATIME*A(2*I)*PDOT(K)
            Q(K)=Q(K)+ATIME*A(2*I+1)*P(K)/W(KK)
         ENDDO
         CALL DVDQ
      ENDDO
      DO K=1,NI
         P(K)=P(K)+ATIME*A(2*N)*PDOT(K)
      ENDDO
C
      RETURN
      END

